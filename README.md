# TikTok-бот

## Описание проекта

TikTok-бот - это автоматизированный Telegram-бот, который периодически публикует трендовые видео с TikTok в указанный Telegram-канал. Бот использует API TikTok для получения трендовых видео, скачивает их и отправляет в канал с заданным интервалом. Для предотвращения дублирования используется база данных, в которой хранятся URL уже опубликованных видео.

## Функциональность

- Автоматическая публикация трендовых видео с TikTok в Telegram-канал
- Планировщик публикаций с настраиваемым интервалом
- Предотвращение дублирования публикаций с помощью базы данных
- Администрирование через команды бота
- Поддержка сессий TikTok для стабильной работы
- Обработка ошибок и логирование действий

## Установка

1. Клонируйте репозиторий:
```bash
git clone <URL_репозитория>
cd my_tiktok_bot
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Установите ffmpeg (если не установлен):
- Скачайте ffmpeg с официального сайта
- Добавьте путь к ffmpeg в переменную окружения PATH

## Настройка

1. Создайте Telegram-бота у @BotFather и получите токен
2. Создайте Telegram-канал или используйте существующий
3. Получите ID канала и вашего пользователя (администратора)
4. Скопируйте файл `.env.example` в `.env` и заполните значениями:

```
BOT_TOKEN=ваш_токен_бота
CHANNEL_ID=ID_вашего_канала
ADMIN_ID=ваш_ID_пользователя
POSTING_INTERVAL_MINUTES=интервал_в_минутах
```

5. Запустите бота для создания сессии TikTok (первый запуск будет в видимом режиме для входа в аккаунт)

## Запуск

Для запуска бота выполните:

```bash
python bot.py
```

После первого запуска и успешного входа в аккаунт TikTok, бот будет работать в фоновом режиме, публикуя видео с заданным интервалом.

## Команды бота

- `/start` - начать работу с ботом
- `/add_post` - добавить видео
- `/delete_post` - удалить пост
- `/help` - справка

## Структура проекта

- `bot.py` - основной файл с логикой бота
- `requirements.txt` - зависимости проекта
- `posted_videos.db` - база данных опубликованных видео
- `.env` - файл с настройками
- `tiktok_session.json` - файл сессии TikTok
- `schedule.json` - файл расписания (если используется)
- `downloads/` - папка для временных файлов

## Технические детали

- Используется библиотека `aiogram` для работы с Telegram Bot API
- Используется библиотека `TikTokApi` для получения видео с TikTok
- Используется `yt-dlp` для скачивания видео
- Используется `APScheduler` для планирования публикаций
- Используется SQLite для хранения информации о публикациях

## Деплой на Render

1.  Создайте репозиторий на GitHub и загрузите туда файлы проекта.
2. Зайдите на [Render Dashboard](https://dashboard.render.com/) и нажмите "New +" -> "Web Service".
3.  Выберите "Build and deploy from a Git repository".
4.  Укажите URL вашего репозитория на GitHub.
5.  В настройках сервиса укажите:
    *   **Environment**: `Python`
    *   **Runtime**: `python-3.1:bullseye` (или более новая версия, совместимая с зависимостями)
    *   **Build Command**: `pip install -r requirements.txt`
    *   **Start Command**: `python bot.py`
6.  В разделе "Environment Variables" укажите переменные окружения:
    *   `BOT_TOKEN`
    *   `CHANNEL_ID`
    *   `ADMIN_ID`
    *   `POSTING_INTERVAL_MINUTES` (опционально, по умолчанию 60)
    *   `ms_token` (если используется для TikTok API)
7.  Нажмите "Create Web Service".